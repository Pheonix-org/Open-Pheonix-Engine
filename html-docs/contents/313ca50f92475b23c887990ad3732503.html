<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>syncAll</title>
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic|Source+Code+Pro:300,400,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="../assets/css/bootstrap.css">
<link rel="stylesheet" href="../assets/css/jquery.bonsai.css">
<link rel="stylesheet" href="../assets/css/main.css">
<link rel="stylesheet" href="../assets/icon-font/icons.css">
<script type="text/javascript" src="../assets/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript" src="../assets/js/bootstrap.js"></script>
<script type="text/javascript" src="../assets/js/jquery.bonsai.js"></script>

  </head>
  <body>
    <div>

      <!-- Name Title -->

      <h1>syncAll</h1>

      <!-- Type and Stereotype -->

      <section style="margin-top: .5em;">
        <span class="alert alert-info">
          <span class="node-icon staruml-icon icon-UMLOperation"></span>
          UMLOperation
        </span>
        
      </section>

      <!-- Path -->

      <section style="margin-top: 10px">
        
        
        
          
          <span class="label label-info"><a href='cf9c8b720f3815adeccaf3ef6e48c6c4.html'><span class='node-icon staruml-icon icon-Project'></span>UML</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='da2be80fe6e48fd9d101c1429f49bd58.html'><span class='node-icon staruml-icon icon-UMLModel'></span>openJDK</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='ee78c922cc529ca62752f771c0bb7b9d.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>java</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='a93b2fc56794e246bf26838d14b54f65.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>lang</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='e4c701803145d5e3dc249c369d7c56bb.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>invoke</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='689ce89d30f6b0d84b840f719f1bf849.html'><span class='node-icon staruml-icon icon-UMLClass'></span>MutableCallSite</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='313ca50f92475b23c887990ad3732503.html'><span class='node-icon staruml-icon icon-UMLOperation'></span>syncAll</a></span>
        
      </section>

      <!-- Diagram -->

      

      <!-- Description -->

      
      <section>
        <h3>Description</h3>
        <div>
          
            <p>Performs a synchronization operation on each call site in the given array,
forcing all other threads to throw away any cached values previously
loaded from the target of any of the call sites.
&lt;p&gt;
This operation does not reverse any calls that have already started
on an old target value.
(Java supports {@linkplain java.lang.Object#wait() forward time travel} only.)
&lt;p&gt;
The overall effect is to force all future readers of each call site&#39;s target
to accept the most recently stored value.
(&quot;Most recently&quot; is reckoned relative to the {@code syncAll} itself.)
Conversely, the {@code syncAll} call may block until all readers have
(somehow) decached all previous versions of each call site&#39;s target.
&lt;p&gt;
To avoid race conditions, calls to {@code setTarget} and {@code syncAll}
should generally be performed under some sort of mutual exclusion.
Note that reader threads may observe an updated target as early
as the {@code setTarget} call that install the value
(and before the {@code syncAll} that confirms the value).
On the other hand, reader threads may observe previous versions of
the target until the {@code syncAll} call returns
(and after the {@code setTarget} that attempts to convey the updated version).
&lt;p&gt;
This operation is likely to be expensive and should be used sparingly.
If possible, it should be buffered for batch processing on sets of call sites.
&lt;p&gt;
If {@code sites} contains a null element,
a {@code NullPointerException} will be raised.
In this case, some non-null elements in the array may be
processed before the method returns abnormally.
Which elements these are (if any) is implementation-dependent.
&lt;h4&gt;Java Memory Model details&lt;/h4&gt;
In terms of the Java Memory Model, this operation performs a synchronization
action which is comparable in effect to the writing of a volatile variable
by the current thread, and an eventual volatile read by every other thread
that may access one of the affected call sites.
&lt;p&gt;
The following effects are apparent, for each individual call site {@code S}:
&lt;ul&gt;
&lt;li&gt;A new volatile variable {@code V} is created, and written by the current thread.
As defined by the JMM, this write is a global synchronization event.
&lt;li&gt;As is normal with thread-local ordering of write events,
every action already performed by the current thread is
taken to happen before the volatile write to {@code V}.
(In some implementations, this means that the current thread
performs a global release operation.)
&lt;li&gt;Specifically, the write to the current target of {@code S} is
taken to happen before the volatile write to {@code V}.
&lt;li&gt;The volatile write to {@code V} is placed
(in an implementation specific manner)
in the global synchronization order.
&lt;li&gt;Consider an arbitrary thread {@code T} (other than the current thread).
If {@code T} executes a synchronization action {@code A}
after the volatile write to {@code V} (in the global synchronization order),
it is therefore required to see either the current target
of {@code S}, or a later write to that target,
if it executes a read on the target of {@code S}.
(This constraint is called &quot;synchronization-order consistency&quot;.)
&lt;li&gt;The JMM specifically allows optimizing compilers to elide
reads or writes of variables that are known to be useless.
Such elided reads and writes have no effect on the happens-before
relation.  Regardless of this fact, the volatile {@code V}
will not be elided, even though its written value is
indeterminate and its read value is not used.
&lt;/ul&gt;
Because of the last point, the implementation behaves as if a
volatile read of {@code V} were performed by {@code T}
immediately after its action {@code A}.  In the local ordering
of actions in {@code T}, this read happens before any future
read of the target of {@code S}.  It is as if the
implementation arbitrarily picked a read of {@code S}&#39;s target
by {@code T}, and forced a read of {@code V} to precede it,
thereby ensuring communication of the new target value.
&lt;p&gt;
As long as the constraints of the Java Memory Model are obeyed,
implementations may delay the completion of a {@code syncAll}
operation while other threads ({@code T} above) continue to
use previous values of {@code S}&#39;s target.
However, implementations are (as always) encouraged to avoid
livelock, and to eventually require all threads to take account
of the updated target.
&lt;p style=&quot;font-size:smaller;&quot;&gt;
&lt;em&gt;Discussion:&lt;/em&gt;
For performance reasons, {@code syncAll} is not a virtual method
on a single call site, but rather applies to a set of call sites.
Some implementations may incur a large fixed overhead cost
for processing one or more synchronization operations,
but a small incremental cost for each additional call site.
In any case, this operation is likely to be costly, since
other threads may have to be somehow interrupted
in order to make them notice the updated target value.
However, it may be observed that a single call to synchronize
several sites has the same formal effect as many calls,
each on just one of the sites.
&lt;p style=&quot;font-size:smaller;&quot;&gt;
&lt;em&gt;Implementation Note:&lt;/em&gt;
Simple implementations of {@code MutableCallSite} may use
a volatile variable for the target of a mutable call site.
In such an implementation, the {@code syncAll} method can be a no-op,
and yet it will conform to the JMM behavior documented above.
@param sites an array of call sites to be synchronized
@throws NullPointerException if the {@code sites} array reference is null
or the array contains a null</p>
          
        </div>
      </section>
      

      <!-- Specification -->

      

      <!-- Directed Relationship -->

      

      <!-- Undirected Relationship -->

      

      <!-- Classifier -->

      

      <!-- Interface -->

      

      <!-- Component -->

      

      <!-- Node -->

      

      <!-- Actor -->

      

      <!-- Use Case -->

      

      <!-- Template Parameters -->

      

      <!-- Literals -->

      

      <!-- Attributes -->

      

      <!-- Operations -->

      

      <!-- Receptions -->

      

      <!-- Extension Points -->

      

      <!-- Parameters -->

      
      <section>
        <h3>Parameters</h3>
        <table class="table table-striped table-bordered">
          <tr>
            <th>Direction</th>
            <th>Name</th>
            <th>Type</th>
            <th>Description</th>
          </tr>
          
          <tr>
            <td>in</td>
            <td><a href="793be973bb2b6803dca1bdc1c13cd82a.html">sites</a></td>
            <td><a href='f6f7da79638ebdd99ccbebee77d59045.html'><span class='node-icon staruml-icon icon-UMLOperation'></span>«constructor»MutableCallSite</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>return</td>
            <td><a href="b7c0ee6db919f92d1adf6937904a8f34.html">(unnamed)</a></td>
            <td>void</td>
            <td></td>
          </tr>
          
        </table>
      </section>
      

      <!-- Diagrams -->

      
      

      <!-- Behavior -->

      

      <!-- Action -->

      

      <!-- Interaction -->

      

      <!-- CombinedFragment -->

      

      <!-- Activity -->

      

      <!-- State Machine -->

      

      <!-- State Machine -->

      

      <!-- State -->

      

      <!-- Vertex -->

      

      <!-- Transition -->

      

      <!-- Data Model (ERD) -->

      

      <!-- Columns (ERD) -->

      

      <!-- Related Entities (ERD) -->

      

      <!-- Data Flows (DFD) -->

      

      <!-- Flows (Flowchart) -->

      

      <!-- Properties -->

      <section>
        <h3>Properties</h3>
        
        <table class="table table-striped table-bordered">
    <tr>
        <th width="50%">Name</th>
        <th width="50%">Value</th>
    </tr>
    
    
    
    
    
    
    
    <tr>
        <td>name</td>
        <td>syncAll</td>
    </tr>
    
    
    
    
    
    
    
    
    
    
    
    <tr>
        <td>stereotype</td>
        <td><span class='label label-info'>null</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>visibility</td>
        <td>public</td>
    </tr>
    
    
    
    
    
    
    
    <tr>
        <td>isStatic</td>
        <td><span class='label label-info'>true</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>isLeaf</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>parameters</td>
        <td>
            
            
            <a href='793be973bb2b6803dca1bdc1c13cd82a.html'><span class='node-icon staruml-icon icon-UMLParameter'></span>sites</a>
            
            <span>, </span>
            <a href='b7c0ee6db919f92d1adf6937904a8f34.html'><span class='node-icon staruml-icon icon-UMLParameter'></span>(Parameter)</a>
            
        </td>
    </tr>
    
    
    
    
    
    <tr>
        <td>raisedExceptions</td>
        <td>
            
        </td>
    </tr>
    
    
    
    
    
    <tr>
        <td>concurrency</td>
        <td>sequential</td>
    </tr>
    
    
    
    
    
    <tr>
        <td>isQuery</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>isAbstract</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>specification</td>
        <td></td>
    </tr>
    
    
    
    
    
    
    
    
    
</table>                

      </section>

      <!-- Tags -->

      

      <!-- Constraints, Dependencies, Dependants -->

      
        
        


        
        


        
        

      

      <!-- Relationships -->

      
      


      <!-- Owned Elements -->

      
      


    </div>
  </body>
</html>
