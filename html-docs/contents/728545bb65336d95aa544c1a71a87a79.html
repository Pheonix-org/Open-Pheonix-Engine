<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>ThreadLocal</title>
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic|Source+Code+Pro:300,400,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="../assets/css/bootstrap.css">
<link rel="stylesheet" href="../assets/css/jquery.bonsai.css">
<link rel="stylesheet" href="../assets/css/main.css">
<link rel="stylesheet" href="../assets/icon-font/icons.css">
<script type="text/javascript" src="../assets/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript" src="../assets/js/bootstrap.js"></script>
<script type="text/javascript" src="../assets/js/jquery.bonsai.js"></script>

  </head>
  <body>
    <div>

      <!-- Name Title -->

      <h1>ThreadLocal</h1>

      <!-- Type and Stereotype -->

      <section style="margin-top: .5em;">
        <span class="alert alert-info">
          <span class="node-icon staruml-icon icon-UMLClass"></span>
          UMLClass
        </span>
        
      </section>

      <!-- Path -->

      <section style="margin-top: 10px">
        
        
        
          
          <span class="label label-info"><a href='cf9c8b720f3815adeccaf3ef6e48c6c4.html'><span class='node-icon staruml-icon icon-Project'></span>UML</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='da2be80fe6e48fd9d101c1429f49bd58.html'><span class='node-icon staruml-icon icon-UMLModel'></span>openJDK</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='ee78c922cc529ca62752f771c0bb7b9d.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>java</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='a93b2fc56794e246bf26838d14b54f65.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>lang</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='728545bb65336d95aa544c1a71a87a79.html'><span class='node-icon staruml-icon icon-UMLClass'></span>ThreadLocal</a></span>
        
      </section>

      <!-- Diagram -->

      

      <!-- Description -->

      
      <section>
        <h3>Description</h3>
        <div>
          
            <p>Copyright (c) 1997, 2013, Oracle and/or its affiliates. All rights reserved.
DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
This code is free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License version 2 only, as
published by the Free Software Foundation.  Oracle designates this
particular file as subject to the &quot;Classpath&quot; exception as provided
by Oracle in the LICENSE file that accompanied this code.
This code is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
version 2 for more details (a copy is included in the LICENSE file that
accompanied this code).
You should have received a copy of the GNU General Public License version
2 along with this work; if not, write to the Free Software Foundation,
Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
or visit www.oracle.com if you need additional information or have any
questions.
This class provides thread-local variables.  These variables differ from
their normal counterparts in that each thread that accesses one (via its
{@code get} or {@code set} method) has its own, independently initialized
copy of the variable.  {@code ThreadLocal} instances are typically private
static fields in classes that wish to associate state with a thread (e.g.,
a user ID or Transaction ID).
&lt;p&gt;For example, the class below generates unique identifiers local to each
thread.
A thread&#39;s id is assigned the first time it invokes {@code ThreadId.get()}
and remains unchanged on subsequent calls.
&lt;pre&gt;
import java.util.concurrent.atomic.AtomicInteger;
public class ThreadId {
// Atomic integer containing the next thread ID to be assigned
private static final AtomicInteger nextId = new AtomicInteger(0);
// Thread local variable containing each thread&#39;s ID
private static final ThreadLocal&amp;lt;Integer&amp;gt; threadId =
new ThreadLocal&amp;lt;Integer&amp;gt;() {
&amp;#64;Override protected Integer initialValue() {
return nextId.getAndIncrement();
}
};
// Returns the current thread&#39;s unique ID, assigning it if necessary
public static int get() {
return threadId.get();
}
}
&lt;/pre&gt;
&lt;p&gt;Each thread holds an implicit reference to its copy of a thread-local
variable as long as the thread is alive and the {@code ThreadLocal}
instance is accessible; after a thread goes away, all of its copies of
thread-local instances are subject to garbage collection (unless other
references to these copies exist).
@author  Josh Bloch and Doug Lea
@since   1.2</p>
          
        </div>
      </section>
      

      <!-- Specification -->

      

      <!-- Directed Relationship -->

      

      <!-- Undirected Relationship -->

      

      <!-- Classifier -->

      
        
        


        
        
<section class="element-list">
    <h3>Specialized Elements</h3>
    <ul class="nav nav-list">
        
        <li><a href='a2fe54276b09584027efc8541fdffa97.html'><span class='node-icon staruml-icon icon-UMLClass'></span>InheritableThreadLocal</a></li>
        
    </ul>
</section>



        
        


        
        


        
        

      

      <!-- Interface -->

      

      <!-- Component -->

      

      <!-- Node -->

      

      <!-- Actor -->

      

      <!-- Use Case -->

      

      <!-- Template Parameters -->

      
      <section>
        <h3>Template Parameters</h3>
        <table class="table table-striped table-bordered">
          <tr>
            <th>Visibility</th>
            <th>Name</th>
            <th>Type</th>
            <th>Description</th>
          </tr>
          
          <tr>
            <td>public</td>
            <td><a href="00e5265cdb090e24d93a2a2d4824eb6c.html">T</a></td>
            <td></td>
            <td></td>
          </tr>
          
        </table>
      </section>
      

      <!-- Literals -->

      

      <!-- Attributes -->

      
      <section>
        <h3>Attributes</h3>
        <table class="table table-striped table-bordered">
          <tr>
            <th>Visibility</th>
            <th>Name</th>
            <th>Type</th>
            <th>Description</th>
          </tr>
          
          <tr>
            <td>private</td>
            <td><a href="f33b1eb273a52a42c27a2f99bdd2a4a3.html">threadLocalHashCode</a></td>
            <td>int</td>
            <td><p>ThreadLocals rely on per-thread linear-probe hash maps attached
to each thread (Thread.threadLocals and
inheritableThreadLocals).  The ThreadLocal objects act as keys,
searched via threadLocalHashCode.  This is a custom hash code
(useful only within ThreadLocalMaps) that eliminates collisions
in the common case where consecutively constructed ThreadLocals
are used by the same threads, while remaining well-behaved in
less common cases.</p></td>
          </tr>
          
          <tr>
            <td>private</td>
            <td><a href="1409ae9bddecd4b94dd6b81346a740e7.html">nextHashCode</a></td>
            <td><a href='c8d8220123b629d87dff3667ce713aec.html'>AtomicInteger</a></td>
            <td><p>The next hash code to be given out. Updated atomically. Starts at
zero.</p></td>
          </tr>
          
          <tr>
            <td>private</td>
            <td><a href="07533ddd2d12d81dc863ed44dd11b949.html">HASH_INCREMENT</a></td>
            <td>int</td>
            <td><p>The difference between successively generated hash codes - turns
implicit sequential thread-local IDs into near-optimally spread
multiplicative hash values for power-of-two-sized tables.</p></td>
          </tr>
          
        </table>
      </section>
      

      <!-- Operations -->

      
      <section>
        <h3>Operations</h3>
        <table class="table table-striped table-bordered">
          <tr>
            <th>Visibility</th>
            <th>Name</th>
            <th>Description</th>
          </tr>
          
          <tr>
            <td>private</td>
            <td><a href="ba068a383716c78d91af0bdf17ff4e6f.html">nextHashCode(): int</a></td>
            <td><p>Returns the next hash code.</p></td>
          </tr>
          
          <tr>
            <td>protected</td>
            <td><a href="db704e96c4dd9cbaad63ae33957ec9ab.html">initialValue(): T</a></td>
            <td><p>Returns the current thread&#39;s &quot;initial value&quot; for this
thread-local variable.  This method will be invoked the first
time a thread accesses the variable with the {@link #get}
method, unless the thread previously invoked the {@link #set}
method, in which case the {@code initialValue} method will not
be invoked for the thread.  Normally, this method is invoked at
most once per thread, but it may be invoked again in case of
subsequent invocations of {@link #remove} followed by {@link #get}.
&lt;p&gt;This implementation simply returns {@code null}; if the
programmer desires thread-local variables to have an initial
value other than {@code null}, {@code ThreadLocal} must be
subclassed, and this method overridden.  Typically, an
anonymous inner class will be used.
@return the initial value for this thread-local</p></td>
          </tr>
          
          <tr>
            <td>public</td>
            <td><a href="3cb5c7632f6edec151802c7897dc27be.html">withInitial(supplier: Supplier): ThreadLocal</a></td>
            <td><p>Creates a thread local variable. The initial value of the variable is
determined by invoking the {@code get} method on the {@code Supplier}.
@param &lt;S&gt; the type of the thread local&#39;s value
@param supplier the supplier to be used to determine the initial value
@return a new thread local variable
@throws NullPointerException if the specified supplier is null
@since 1.8</p></td>
          </tr>
          
          <tr>
            <td>public</td>
            <td><a href="00e7737e116e9df42cc941c65e983e3f.html">ThreadLocal()</a></td>
            <td><p>Creates a thread local variable.
@see #withInitial(java.util.function.Supplier)</p></td>
          </tr>
          
          <tr>
            <td>public</td>
            <td><a href="ef9c45f7063eaa1a92ec6a0e7adfb860.html">get(): T</a></td>
            <td><p>Returns the value in the current thread&#39;s copy of this
thread-local variable.  If the variable has no value for the
current thread, it is first initialized to the value returned
by an invocation of the {@link #initialValue} method.
@return the current thread&#39;s value of this thread-local</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="358320700cdc95122be7e77b32740be3.html">isPresent(): boolean</a></td>
            <td><p>Returns {@code true} if there is a value in the current thread&#39;s copy of
this thread-local variable, even if that values is {@code null}.
@return {@code true} if current thread has associated value in this
thread-local variable; {@code false} if not</p></td>
          </tr>
          
          <tr>
            <td>private</td>
            <td><a href="5be9293e858a1df72f83b0230eabf4ae.html">setInitialValue(): T</a></td>
            <td><p>Variant of set() to establish initialValue. Used instead
of set() in case user has overridden the set() method.
@return the initial value</p></td>
          </tr>
          
          <tr>
            <td>public</td>
            <td><a href="c5ee24dfd8315d4f51c4da8617280640.html">set(value: T): void</a></td>
            <td><p>Sets the current thread&#39;s copy of this thread-local variable
to the specified value.  Most subclasses will have no need to
override this method, relying solely on the {@link #initialValue}
method to set the values of thread-locals.
@param value the value to be stored in the current thread&#39;s copy of
this thread-local.</p></td>
          </tr>
          
          <tr>
            <td>public</td>
            <td><a href="37e6617d8a87d648b46ab1517635fe05.html">remove(): void</a></td>
            <td><p>Removes the current thread&#39;s value for this thread-local
variable.  If this thread-local variable is subsequently
{@linkplain #get read} by the current thread, its value will be
reinitialized by invoking its {@link #initialValue} method,
unless its value is {@linkplain #set set} by the current thread
in the interim.  This may result in multiple invocations of the
{@code initialValue} method in the current thread.
@since 1.5</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="19738343c31cfbcb47ac98ba542f556a.html">getMap(t: Thread): ThreadLocalMap</a></td>
            <td><p>Get the map associated with a ThreadLocal. Overridden in
InheritableThreadLocal.
@param  t the current thread
@return the map</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="54034fbd2f91eb53c8acf2e262b84c15.html">createMap(t: Thread, firstValue: T): void</a></td>
            <td><p>Create the map associated with a ThreadLocal. Overridden in
InheritableThreadLocal.
@param t the current thread
@param firstValue value for the initial entry of the map</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="2a8d7483ce5e5687e95a0e1d1af75be7.html">createInheritedMap(parentMap: ThreadLocalMap): ThreadLocalMap</a></td>
            <td><p>Factory method to create map of inherited thread locals.
Designed to be called only from Thread constructor.
@param  parentMap the map associated with parent thread
@return a map containing the parent&#39;s inheritable bindings</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="0b0cfa7fac0396c816b0098759c65956.html">childValue(parentValue: T): T</a></td>
            <td><p>Method childValue is visibly defined in subclass
InheritableThreadLocal, but is internally defined here for the
sake of providing createInheritedMap factory method without
needing to subclass the map class in InheritableThreadLocal.
This technique is preferable to the alternative of embedding
instanceof tests in methods.</p></td>
          </tr>
          
        </table>
      </section>
      

      <!-- Receptions -->

      

      <!-- Extension Points -->

      

      <!-- Parameters -->

      

      <!-- Diagrams -->

      
      

      <!-- Behavior -->

      

      <!-- Action -->

      

      <!-- Interaction -->

      

      <!-- CombinedFragment -->

      

      <!-- Activity -->

      

      <!-- State Machine -->

      

      <!-- State Machine -->

      

      <!-- State -->

      

      <!-- Vertex -->

      

      <!-- Transition -->

      

      <!-- Data Model (ERD) -->

      

      <!-- Columns (ERD) -->

      

      <!-- Related Entities (ERD) -->

      

      <!-- Data Flows (DFD) -->

      

      <!-- Flows (Flowchart) -->

      

      <!-- Properties -->

      <section>
        <h3>Properties</h3>
        
        <table class="table table-striped table-bordered">
    <tr>
        <th width="50%">Name</th>
        <th width="50%">Value</th>
    </tr>
    
    
    
    
    
    
    
    <tr>
        <td>name</td>
        <td>ThreadLocal</td>
    </tr>
    
    
    
    
    
    
    
    
    
    
    
    <tr>
        <td>stereotype</td>
        <td><span class='label label-info'>null</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>visibility</td>
        <td>public</td>
    </tr>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <tr>
        <td>isAbstract</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>isFinalSpecialization</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>isLeaf</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>isActive</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
</table>                

      </section>

      <!-- Tags -->

      

      <!-- Constraints, Dependencies, Dependants -->

      
        
        


        
        


        
        

      

      <!-- Relationships -->

      
      
<section class="element-list">
    <h3>Relationships</h3>
    <ul class="nav nav-list">
        
        <li><a href='e5d1e2aa88efa6291ffd35778f43743b.html'><span class='node-icon staruml-icon icon-UMLGeneralization'></span>(InheritableThreadLocal→ThreadLocal)</a></li>
        
        <li><a href='3de1940fb94b44bd7664a5af5d1a1817.html'><span class='node-icon staruml-icon icon-UMLAssociation'></span>(StringCoding—ThreadLocal)</a></li>
        
        <li><a href='606ec029b15d57551a2b76fe7d3178b2.html'><span class='node-icon staruml-icon icon-UMLAssociation'></span>(StringCoding—ThreadLocal)</a></li>
        
        <li><a href='51c059a5db15fd2bbd4282190e18282f.html'><span class='node-icon staruml-icon icon-UMLAssociation'></span>(StringCoding—ThreadLocal)</a></li>
        
    </ul>
</section>



      <!-- Owned Elements -->

      
      
<section class="element-list">
    <h3>Owned Elements</h3>
    <ul class="nav nav-list">
        
        <li><a href='459d124462ded66a1b1636e185037c44.html'><span class='node-icon staruml-icon icon-UMLClass'></span>SuppliedThreadLocal</a></li>
        
        <li><a href='93c91793b382c461f3c4623b2af3d3df.html'><span class='node-icon staruml-icon icon-UMLClass'></span>ThreadLocalMap</a></li>
        
    </ul>
</section>



    </div>
  </body>
</html>
