<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>MethodHandleNatives</title>
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic|Source+Code+Pro:300,400,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="../assets/css/bootstrap.css">
<link rel="stylesheet" href="../assets/css/jquery.bonsai.css">
<link rel="stylesheet" href="../assets/css/main.css">
<link rel="stylesheet" href="../assets/icon-font/icons.css">
<script type="text/javascript" src="../assets/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript" src="../assets/js/bootstrap.js"></script>
<script type="text/javascript" src="../assets/js/jquery.bonsai.js"></script>

  </head>
  <body>
    <div>

      <!-- Name Title -->

      <h1>MethodHandleNatives</h1>

      <!-- Type and Stereotype -->

      <section style="margin-top: .5em;">
        <span class="alert alert-info">
          <span class="node-icon staruml-icon icon-UMLClass"></span>
          UMLClass
        </span>
        
      </section>

      <!-- Path -->

      <section style="margin-top: 10px">
        
        
        
          
          <span class="label label-info"><a href='cf9c8b720f3815adeccaf3ef6e48c6c4.html'><span class='node-icon staruml-icon icon-Project'></span>UML</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='da2be80fe6e48fd9d101c1429f49bd58.html'><span class='node-icon staruml-icon icon-UMLModel'></span>openJDK</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='ee78c922cc529ca62752f771c0bb7b9d.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>java</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='a93b2fc56794e246bf26838d14b54f65.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>lang</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='e4c701803145d5e3dc249c369d7c56bb.html'><span class='node-icon staruml-icon icon-UMLPackage'></span>invoke</a></span>
        
          <span>::</span>
          <span class="label label-info"><a href='473debfec3443339bd5a233bee30bbc4.html'><span class='node-icon staruml-icon icon-UMLClass'></span>MethodHandleNatives</a></span>
        
      </section>

      <!-- Diagram -->

      

      <!-- Description -->

      
      <section>
        <h3>Description</h3>
        <div>
          
            <p>Determines if the underlying member was a variable arity method or constructor.
Such members are represented by method handles that are varargs collectors.
@implSpec
This produces a result equivalent to:
&lt;pre&gt;{@code
getReferenceKind() &gt;= REF_invokeVirtual &amp;&amp; Modifier.isTransient(getModifiers())
}&lt;/pre&gt;
@return {@code true} if and only if the underlying member was declared with variable arity.
Copyright (c) 2008, 2019, Oracle and/or its affiliates. All rights reserved.
DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
This code is free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License version 2 only, as
published by the Free Software Foundation.  Oracle designates this
particular file as subject to the &quot;Classpath&quot; exception as provided
by Oracle in the LICENSE file that accompanied this code.
This code is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
version 2 for more details (a copy is included in the LICENSE file that
accompanied this code).
You should have received a copy of the GNU General Public License version
2 along with this work; if not, write to the Free Software Foundation,
Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
or visit www.oracle.com if you need additional information or have any
questions.
The JVM interface for the method handles package is all here.
This is an interface internal and private to an implementation of JSR 292.
&lt;em&gt;This class is not part of the JSR 292 standard.&lt;/em&gt;
@author jrose</p>
          
        </div>
      </section>
      

      <!-- Specification -->

      

      <!-- Directed Relationship -->

      

      <!-- Undirected Relationship -->

      

      <!-- Classifier -->

      
        
        


        
        


        
        


        
        


        
        

      

      <!-- Interface -->

      

      <!-- Component -->

      

      <!-- Node -->

      

      <!-- Actor -->

      

      <!-- Use Case -->

      

      <!-- Template Parameters -->

      

      <!-- Literals -->

      

      <!-- Attributes -->

      

      <!-- Operations -->

      
      <section>
        <h3>Operations</h3>
        <table class="table table-striped table-bordered">
          <tr>
            <th>Visibility</th>
            <th>Name</th>
            <th>Description</th>
          </tr>
          
          <tr>
            <td>private</td>
            <td><a href="b3fe648f02348f31a35fc7dfd9d40b38.html">MethodHandleNatives()</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="6513dc3bac1a9352f46b5d3e54feeb6c.html">init(self: MemberName, ref: Object): void</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="40fbdd6349d9b3c3b1c77c6d6d6464af.html">expand(self: MemberName): void</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="95688434e6c83a5d7b0f49b1128f6dcf.html">resolve(self: MemberName, caller: Class, speculativeResolve: boolean): MemberName</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="94dcb6e298b3079c6cc93041f5189e1c.html">getMembers(defc: Class, matchName: String, matchSig: String, matchFlags: int, caller: Class, skip: int, results: MemberName): int</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="718811d5c848654ef1f8303a82f543b3.html">objectFieldOffset(self: MemberName): long</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="d5cec52d87978bc608a87b415dfae692.html">staticFieldOffset(self: MemberName): long</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="bb5e3c1303c12b2384d46795ea08abf6.html">staticFieldBase(self: MemberName): Object</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="658b43612ca8a605c1152b936551f19f.html">getMemberVMInfo(self: MemberName): Object</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="df554d629b0c850eaed104b238e02057.html">setCallSiteTargetNormal(site: CallSite, target: MethodHandle): void</a></td>
            <td><p>Tell the JVM that we need to change the target of a CallSite.</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="9b838c04f7601f179c1e6a07c83a5065.html">setCallSiteTargetVolatile(site: CallSite, target: MethodHandle): void</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="4253ec800335a187cec53762f9e9cb4a.html">copyOutBootstrapArguments(caller: Class, indexInfo: int, start: int, end: int, buf: Object, pos: int, resolve: boolean, ifNotAvailable: Object): void</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>private</td>
            <td><a href="f0485a39a60d447b4218a391c79a62d8.html">clearCallSiteContext(context: CallSiteContext): void</a></td>
            <td><p>Invalidate all recorded nmethods.</p></td>
          </tr>
          
          <tr>
            <td>private</td>
            <td><a href="0293be014be665b5fa5db9b71f4779e4.html">registerNatives(): void</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="044ca7667f0c74253acf5a8ef34adfc9.html">refKindIsValid(refKind: int): boolean</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="58912e1d1b5f321c5f63c66f4e7372dd.html">refKindIsField(refKind: byte): boolean</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="30714695e3756a5e6b5f25ee605dfff7.html">refKindIsGetter(refKind: byte): boolean</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="c0de947619cf82fe886b806e56efdc32.html">refKindIsSetter(refKind: byte): boolean</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="f09e1b8502559d7ecfdb7fdc74e38f09.html">refKindIsMethod(refKind: byte): boolean</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="9f15a32ca0aaa3ff5db2e2c60ab9eb32.html">refKindIsConstructor(refKind: byte): boolean</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="688e9860c64bfc1509661361383a56a3.html">refKindHasReceiver(refKind: byte): boolean</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="962c85bd85affd2147e702798ced3e13.html">refKindIsStatic(refKind: byte): boolean</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="19f3deff1dbbae53b93fd987403fc83a.html">refKindDoesDispatch(refKind: byte): boolean</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="6b6e9a6374e3ad728cb0175d8e526f04.html">refKindName(refKind: byte): String</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>private</td>
            <td><a href="5b75ad1b546485abc57d5de743a4a76a.html">getNamedCon(which: int, name: Object): int</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="b81294ec5eb9e52ac54a09f27e5123d6.html">verifyConstants(): boolean</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="2601d8dea11d5afcaa8db8184c24ba2b.html">linkCallSite(callerObj: Object, indexInCP: int, bootstrapMethodObj: Object, nameObj: Object, typeObj: Object, staticArguments: Object, appendixResult: Object): MemberName</a></td>
            <td><p>The JVM is linking an invokedynamic instruction.  Create a reified call site for it.</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="108fbd2bea2a5f55171512956cb2712d.html">linkCallSiteImpl(caller: Class, bootstrapMethod: MethodHandle, name: String, type: MethodType, staticArguments: Object, appendixResult: Object): MemberName</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="da3bce24db8c6ee0860a2f301b37290a.html">linkCallSiteTracing(caller: Class, bootstrapMethod: MethodHandle, name: String, type: MethodType, staticArguments: Object, appendixResult: Object): MemberName</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="74a085a0bffff1585b6dacd6cd8f00e6.html">linkDynamicConstant(callerObj: Object, indexInCP: int, bootstrapMethodObj: Object, nameObj: Object, typeObj: Object, staticArguments: Object): Object</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="191a40dff7eb5e40089b1e202e8d4fe4.html">linkDynamicConstantImpl(caller: Class, bootstrapMethod: MethodHandle, name: String, type: Class, staticArguments: Object): Object</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>private</td>
            <td><a href="d80f7c6ebe1850613a2890f6f5055330.html">staticArglistForTrace(staticArguments: Object): String</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="1db40e25bdbde56606de7dd3d48f3414.html">linkDynamicConstantTracing(caller: Class, bootstrapMethod: MethodHandle, name: String, type: Class, staticArguments: Object): Object</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="b95e3e73b83efc68f4866703a9e7f304.html">staticArgumentsPulled(staticArguments: Object): boolean</a></td>
            <td><p>The JVM is requesting pull-mode bootstrap when it provides
a tuple of the form int[]{ argc, vmindex }.
The BSM is expected to call back to the JVM using the caller
class and vmindex to resolve the static arguments.</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="0f023371cfbacef71eda0b8598e818fb.html">isPullModeBSM(bsm: MethodHandle): boolean</a></td>
            <td><p>A BSM runs in pull-mode if and only if its sole arguments
are (Lookup, BootstrapCallInfo), or can be converted pairwise
to those types, and it is not of variable arity.
Excluding error cases, we can just test that the arity is a constant 2.
NOTE: This method currently returns false, since pulling is not currently
exposed to a BSM. When pull mode is supported the method block will be
replaced with currently commented out code.</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="98bc75d65b55300fd8da01d872ec9f70.html">findMethodHandleType(rtype: Class, ptypes: Class): MethodType</a></td>
            <td><p>The JVM wants a pointer to a MethodType.  Oblige it by finding or creating one.</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="66a4bd9d1702bd120c2361453a0224a3.html">linkMethod(callerClass: Class, refKind: int, defc: Class, name: String, type: Object, appendixResult: Object): MemberName</a></td>
            <td><p>The JVM wants to link a call site that requires a dynamic type check.
Name is a type-checking invoker, invokeExact or invoke.
Return a JVM method (MemberName) to handle the invoking.
The method assumes the following arguments on the stack:
0: the method handle being invoked
1-N: the arguments to the method handle invocation
N+1: an optional, implicitly added argument (typically the given MethodType)
&lt;p&gt;
The nominal method at such a call site is an instance of
a signature-polymorphic method (see @PolymorphicSignature).
Such method instances are user-visible entities which are
&quot;split&quot; from the generic placeholder method in {@code MethodHandle}.
(Note that the placeholder method is not identical with any of
its instances.  If invoked reflectively, is guaranteed to throw an
{@code UnsupportedOperationException}.)
If the signature-polymorphic method instance is ever reified,
it appears as a &quot;copy&quot; of the original placeholder
(a native final member of {@code MethodHandle}) except
that its type descriptor has shape required by the instance,
and the method instance is &lt;em&gt;not&lt;/em&gt; varargs.
The method instance is also marked synthetic, since the
method (by definition) does not appear in Java source code.
&lt;p&gt;
The JVM is allowed to reify this method as instance metadata.
For example, {@code invokeBasic} is always reified.
But the JVM may instead call {@code linkMethod}.
If the result is an
ordered pair of a {@code (method, appendix)},
the method gets all the arguments (0..N inclusive)
plus the appendix (N+1), and uses the appendix to complete the call.
In this way, one reusable method (called a &quot;linker method&quot;)
can perform the function of any number of polymorphic instance
methods.
&lt;p&gt;
Linker methods are allowed to be weakly typed, with any or
all references rewritten to {@code Object} and any primitives
(except {@code long}/{@code float}/{@code double})
rewritten to {@code int}.
A linker method is trusted to return a strongly typed result,
according to the specific method type descriptor of the
signature-polymorphic instance it is emulating.
This can involve (as necessary) a dynamic check using
data extracted from the appendix argument.
&lt;p&gt;
The JVM does not inspect the appendix, other than to pass
it verbatim to the linker method at every call.
This means that the JDK runtime has wide latitude
for choosing the shape of each linker method and its
corresponding appendix.
Linker methods should be generated from {@code LambdaForm}s
so that they do not become visible on stack traces.
&lt;p&gt;
The {@code linkMethod} call is free to omit the appendix
(returning null) and instead emulate the required function
completely in the linker method.
As a corner case, if N==255, no appendix is possible.
In this case, the method returned must be custom-generated to
perform any needed type checking.
&lt;p&gt;
If the JVM does not reify a method at a call site, but instead
calls {@code linkMethod}, the corresponding call represented
in the bytecodes may mention a valid method which is not
representable with a {@code MemberName}.
Therefore, use cases for {@code linkMethod} tend to correspond to
special cases in reflective code such as {@code findVirtual}
or {@code revealDirect}.</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="8246df9d825657c214fcae392523bc80.html">linkMethodImpl(callerClass: Class, refKind: int, defc: Class, name: String, type: Object, appendixResult: Object): MemberName</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>private</td>
            <td><a href="42432ecb1273b2a91d138d666a69d199.html">fixMethodType(callerClass: Class, type: Object): MethodType</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="6383ea4448fbf9faca75916c8300caa6.html">linkMethodTracing(callerClass: Class, refKind: int, defc: Class, name: String, type: Object, appendixResult: Object): MemberName</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>private</td>
            <td><a href="2e82690323299b193381011611b6885d.html">varHandleOperationLinkerMethod(name: String, mtype: MethodType, appendixResult: Object): MemberName</a></td>
            <td><p>Obtain the method to link to the VarHandle operation.
This method is located here and not in Invokers to avoid
intializing that and other classes early on in VM bootup.</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="a2907895ff856792a240d17d44139015.html">getVarHandleGuardMethodName(guardType: MethodType): String</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="b2483e7da0432c0b8bbc5ad84e8c27ae.html">getCharType(pt: Class): char</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="d4a71039fb534dfbcfc2358ae6e0382c.html">newNoSuchMethodErrorOnVarHandle(name: String, mtype: MethodType): NoSuchMethodError</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="c6f6bfd472cd2aab23110e05ac16bb51.html">linkMethodHandleConstant(callerClass: Class, refKind: int, defc: Class, name: String, type: Object): MethodHandle</a></td>
            <td><p>The JVM is resolving a CONSTANT_MethodHandle CP entry.  And it wants our help.
It will make an up-call to this method.  (Do not change the name or signature.)
The type argument is a Class for field requests and a MethodType for non-fields.
&lt;p&gt;
Recent versions of the JVM may also pass a resolved MemberName for the type.
In that case, the name is ignored and may be null.</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="2ecb803c7a50c16aa7fc992462c6a7b1.html">mapLookupExceptionToError(ex: ReflectiveOperationException): LinkageError</a></td>
            <td><p>Map a reflective exception to a linkage error.</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="564e6b6dc4f3296bbcbb6feef7288143.html">initCauseFrom(err: E, ex: Exception): E</a></td>
            <td><p>Use best possible cause for err.initCause(), substituting the
cause for err itself if the cause has the same (or better) type.</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="8a21de12110d92fa4041fdde3170043e.html">isCallerSensitive(mem: MemberName): boolean</a></td>
            <td><p>Is this method a caller-sensitive method?
I.e., does it call Reflection.getCallerClass or a similar method
to ask about the identity of its caller?</p></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="0012323b555ac15f585e0fe1be70cf7a.html">canBeCalledVirtual(mem: MemberName): boolean</a></td>
            <td></td>
          </tr>
          
          <tr>
            <td>package</td>
            <td><a href="a2095281cab6c58ff454ee731656f1b3.html">canBeCalledVirtual(symbolicRef: MemberName, definingClass: Class): boolean</a></td>
            <td></td>
          </tr>
          
        </table>
      </section>
      

      <!-- Receptions -->

      

      <!-- Extension Points -->

      

      <!-- Parameters -->

      

      <!-- Diagrams -->

      
      

      <!-- Behavior -->

      

      <!-- Action -->

      

      <!-- Interaction -->

      

      <!-- CombinedFragment -->

      

      <!-- Activity -->

      

      <!-- State Machine -->

      

      <!-- State Machine -->

      

      <!-- State -->

      

      <!-- Vertex -->

      

      <!-- Transition -->

      

      <!-- Data Model (ERD) -->

      

      <!-- Columns (ERD) -->

      

      <!-- Related Entities (ERD) -->

      

      <!-- Data Flows (DFD) -->

      

      <!-- Flows (Flowchart) -->

      

      <!-- Properties -->

      <section>
        <h3>Properties</h3>
        
        <table class="table table-striped table-bordered">
    <tr>
        <th width="50%">Name</th>
        <th width="50%">Value</th>
    </tr>
    
    
    
    
    
    
    
    <tr>
        <td>name</td>
        <td>MethodHandleNatives</td>
    </tr>
    
    
    
    
    
    
    
    
    
    
    
    <tr>
        <td>stereotype</td>
        <td><span class='label label-info'>null</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>visibility</td>
        <td>package</td>
    </tr>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <tr>
        <td>isAbstract</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>isFinalSpecialization</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>isLeaf</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
    
    
    <tr>
        <td>isActive</td>
        <td><span class='label label-info'>false</span></td>
    </tr>
    
    
    
</table>                

      </section>

      <!-- Tags -->

      

      <!-- Constraints, Dependencies, Dependants -->

      
        
        


        
        


        
        

      

      <!-- Relationships -->

      
      


      <!-- Owned Elements -->

      
      
<section class="element-list">
    <h3>Owned Elements</h3>
    <ul class="nav nav-list">
        
        <li><a href='86a63683b21ab1e0057da6233a8ed419.html'><span class='node-icon staruml-icon icon-UMLClass'></span>CallSiteContext</a></li>
        
        <li><a href='5f2ef48c3f64d7f38ac7ba6a6d4e0dab.html'><span class='node-icon staruml-icon icon-UMLClass'></span>Constants</a></li>
        
    </ul>
</section>



    </div>
  </body>
</html>
